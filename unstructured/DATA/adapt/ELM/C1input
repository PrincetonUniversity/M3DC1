&inputnl
! C1input1 for initial equilibrium (from geqdsk)
! input: AnalyticModel0.smb, AnalyticModel
!  use m3dc1 RL=1, single processor
!
!
! OUTPUT OPTIONS
! ==============
	ntimepr = 0010	! number of time steps per output
	iprint = 1	! 1 = print detailed debug info
	itimer = 1	! 1 = print timing info
        iwrite_transport_coeffs = 1   ! 1 = output transport coefficient fields
!
!
! NUMERICAL METHOD OPTIONS
! ========================
!
	integrator = 0	! 0 = Crank-Nicholson, 1 = BDF2
	thimp = 1.0	! implicitness parameter for CN
        iupstream = 0
	imp_mod = 1
        imp_bf = 1
!
	jadv = 1
!
	deex = .04
        ihypeta = 1
        ihypamu = 1
	hyper  = 00.00    ! hyper-resistivity (applied to psi)
	hyperi =  0.      ! hyper-resistivity (applied to Bz )
	hyperv =  0.0     ! hyper-viscosity   (applied to vz )
	hyperc = 0.00     ! hyper-viscosity   (applied to chi)
	hyperp = 0.0      ! hyper-pressure-diffusion
!
	dt = 2.0		! time step
	ntimemax  = 01000	! number of time steps
        isplitstep = 1
!
!
! MODEL OPTIONS
! =============
	linear = 1	! 0 = nonlinear; 1 = linear
	eqsubtract = 0	! 1 = subtract equilibrium in nonlinear simulations
      	numvar = 3	! 1 = 3-field; 2 = 4-field; 1 = 6-field
        idens = 0       ! 1 = advance density
        itemp = 1     ! 1 = Advance temperatures rather than pressures
	ipres = 0     ! 1 = advance both ion and electron temperature
        ipressplit = 1    !separate temperature (or pressure) solves from field solve
	gyro = 0
!
	iconstflux = 0  ! 1 = conserve toroidal flux
        inocurrent_pol = 1  ! neumann condition on I
        inocurrent_tor = 0   !  do not zero boundary toroidal current
        iconst_bz = 1       ! no Dirichlet condition on I
!
	regular = 1.e-4
!
!
! PHYSICAL PARAMETERS
! ===================

!
!.......step resistivity function
        iresfunc = 4
        etaoff = 1.
        eta_fac = 100.   ! enhance resistivity over Spitzer
        ivisfunc = 1
      	amu = 1.e-6	 ! core viscosity
        amu_edge = 1.e-5 ! edge viscosity
        amuoff = -0.1
        amudelt = .100
	p0 = .20
	pi0 = .10
!
!
!
        ikappafunc = 0
	kappat = 1.e-5	! isotropic thermal conductivity
	kappa0 = 0.0	!   kappa = kappat + kappa0*p/T^(3/2)
	kappar = 0.0	! field-aligned thermal conductivity
!
	gam = 1.66666666666667	! adiabatic constant
!
	db = 0.0	! ion skin depth

!
!
! boundary conditions
!
!
! EQUILIBRIUM OPTIONS
! ===================

      	itaylor = 1	! determines initial conditions
			! 0: Tilting Cylinder
			! 1: Taylor reconnection -- gradShafranov solver for itor=1
			! 2: Force-free Taylor state
			! 3: GEM-reconnection
			! 4: Wave propagation
!
	eps = 1e-10	! size of initial perturbation
	irestart = 0	! 1 = read restart
        ike_only = 0
!
! TOROIDAL CURRENT CONTROLLER OPTIONS
! ===================================

!
! TOROIDAL GEOMETRY OPTIONS
! =========================
	itor = 1	! 1 = toroidal geometry, 0 = slab geometry
        nplanes = 1
        iread_eqdsk = 1
        iwrite_restart=1
        igs_method = 2
        xlim = 0.00    !  limiting value of x
	zlim = 0.	! limiting value of z
        xnull = 1.30    ! R position of x-point for diverted plasma
        znull = -1.14    ! Z position of x-point for diverted plasma

        th_gs = 0.8    ! blending parameter in GS iteration
        pedge = .0010 ! edge pressure
        igs = 100     ! max number of GS iterations
       tol_gs = 1.e-7 ! tolorance for GS iteration
       ivform = 1
       ibform = 1
!
      ntor = 8
      !iadapt = 1    !  mesh adaptation
      iadapt = 2   !  mesh adaptation
      iadapt_max_node = 15000
      iadapt_useH1=1
      iadapt_removeEquiv =1
      adapt_target_error = 0.005
      adapt_hmin = 0.005
      adapt_hmax = 0.1
      adapt_ke = 5e-2
      iadapt_order_p = 2
      iadapt_writevtk = 1

      iglobalout = 0
      iglobalin = 0
      int_pts_main = 25
      int_pts_aux  = 25
      int_pts_diag = 25
      icsym = 1
      inoslip_pol = 1
      inoslip_tor = 1
      inonormalflow = 1
      inocurrent_norm = 0
      iconst_bn = 1
      iconst_p = 1
      iconst_n = 1
      isurface = 1
      nonrect = 1
      ifixedb = 0
      mesh_filename = Analytic.smb
      mesh_model = AnalyticModel

 /
