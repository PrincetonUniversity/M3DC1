#%Module1.0
##

## Required internal variables

set             name            m3dc1
set             version         devel
set             root            $env(M3DC1_CODE_DIR)

## List conflicting modules here

conflict $name

## List prerequisite modules here

set             fullname        M3D-C1
set             externalurl     http://w3.pppl.gov/~nferraro/m3dc1.html
set             description     "M3D-C1 is an extended-MHD code"

## Required for "module help ..."

proc ModulesHelp { } {
  global description externalurl
  puts stderr "Description - $description"
  puts stderr "Other Docs  - $externalurl"
}

## Required for "module display ..." and SWDB

module-whatis                   "$description"

## Software-specific settings exported to user environment


if { ! [ is-loaded intel/2021.1.2 ] } {
   module load intel/2021.1.2
}

if { ! [ is-loaded intel-mpi/intel/2021.3.1 ] } {
   module load intel-mpi/intel/2021.3.1
}

if { ! [ is-loaded fftw/intel-2021.1/intel-mpi/3.3.9 ] } {
   module load fftw/intel-2021.1/intel-mpi/3.3.9
}

if { ! [ is-loaded hdf5/intel-2021.1/intel-mpi/1.10.6 ] } {
   module load hdf5/intel-2021.1/intel-mpi/1.10.6
}

if { ! [ is-loaded gsl/2.6 ] } {
   module load gsl/2.6
}
if { ! [ is-loaded netcdf/intel-2021.1/hdf5-1.10.6/intel-mpi/4.7.4 ] } {
   module load netcdf/intel-2021.1/hdf5-1.10.6/intel-mpi/4.7.4
}
if { ! [ is-loaded anaconda3/2020.11 ] } {
   module load anaconda3/2020.11
}

setenv          M3DC1_VERSION   $version
setenv          M3DC1_DIR       $root
setenv		M3DC1_ARCH	stellar_mg
setenv		M3DC1_MPIRUN	srun

prepend-path    PATH             $root/unstructured/_stellar_mg/bin
prepend-path    IDL_PATH         $root/unstructured/idl:<IDL_DEFAULT>

