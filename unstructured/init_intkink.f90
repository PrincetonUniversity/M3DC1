!==============================================================================
! int_kink
! ~~~~~~~~~~~~
!==============================================================================
module int_kink


contains

!========================================================
! init
!========================================================
subroutine int_kink_init()
  use basic
  use arrays
  use mesh_mod

  implicit none

  integer :: l, numnodes, icounter_tt
  real :: x, phi, z


  numnodes = owned_nodes()
  do icounter_tt=1,numnodes
     l = nodes_owned(icounter_tt)

     call get_node_pos(l, x, phi, z)

     call get_local_vals(l)

     call int_kink_equ(x, z)
     call int_kink_per(x, phi, z)

     call set_local_vals(l)
  enddo
  call finalize(field_vec)

end subroutine int_kink_init


!========================================================
! equ
!========================================================
subroutine int_kink_equ(x, z)
  use basic
  use arrays

  implicit none

  real, intent(in) :: x, z
  real :: r, preszero
  real, parameter :: alpha=0.6579, rmin=1., pi=3.1415926536
  
  preszero=p0
  r=sqrt(x**2 + z**2)

  if (NUMVAR.eq.1) then
    call constant_field(den0_l, 1.)
    call constant_field(p0_l,p0)
    call constant_field(pe0_l,p0/2.)
    call constant_field(bz0_l,bzero)
  else ! only for rmin=1.

    bz0_l(1) = 0.225079* &
         Sqrt(1.80383 - 0.957984*preszero - 0.108208*(x**2 + z**2) &
         + 3.22684*preszero*(x**2 + z**2) + 0.162312*(x**2 + z**2)**2 &
         - 4.40951*preszero*(x**2 + z**2)**2 - 0.120231*(x**2 + z**2)**3 &
         + 3.28718*preszero*(x**2 + z**2)**3 + 0.0450867*(x**2 + z**2)**4 &
         - 1.5192*preszero*(x**2 + z**2)**4 - 0.00721387*(x**2 + z**2)**5 &
         + 0.45427*preszero*(x**2 + z**2)**5 &
         - 0.0952705*preszero*(x**2 + z**2)**6 &
         + 0.0159547*preszero*(x**2 + z**2)**7 &
         - 0.00245458*preszero*(x**2 + z**2)**8 &
         + 0.00018182*preszero*(x**2 + z**2)**9)

    bz0_l(2) = (0.11253953951963827* &
         (0. - 0.21641620500000003*x + 6.45367005*preszero*x &
         + 0.6492486150000001*x*(x**2 + z**2) &
         - 17.638059524400003*preszero*x*(x**2 + z**2) &
         - 0.7213873500000001*x*(x**2 + z**2)**2 &
         + 19.723090085028453*preszero*x*(x**2 + z**2)**2 &
         + 0.36069367500000005*x*(x**2 + z**2)**3 &
         - 12.153599550456903*preszero*x*(x**2 + z**2)**3 &
         - 0.07213873500000001*x*(x**2 + z**2)**4 &
         + 4.542701632412481*preszero*x*(x**2 + z**2)**4 &
         - 1.1432456270094133*preszero*x*(x**2 + z**2)**5 &
         + 0.2233663877530526*preszero*x*(x**2 + z**2)**6 &
         - 0.03927321103350375*preszero*x*(x**2 + z**2)**7 &
         + 0.003272767586125312*preszero*x*(x**2 + z**2)**8)) &
         / Sqrt(1.8038251465091153 - 0.9579835619689772*preszero &
         - 0.10820810250000001*(x**2 + z**2) &
         + 3.226835025*preszero*(x**2 + z**2) &
         + 0.16231215375000002*(x**2 + z**2)**2 &
         - 4.409514881100001*preszero*(x**2 + z**2)**2 &
         - 0.12023122500000001*(x**2 + z**2)**3 &
         + 3.287181680838075*preszero*(x**2 + z**2)**3 &
         + 0.045086709375000006*(x**2 + z**2)**4 &
         - 1.5191999438071129*preszero*(x**2 + z**2)**4 &
         - 0.0072138735000000015*(x**2 + z**2)**5 &
         + 0.4542701632412481*preszero*(x**2 + z**2)**5 &
         - 0.09527046891745111*preszero*(x**2 + z**2)**6 &
         + 0.0159547419823609*preszero*(x**2 + z**2)**7 &
         - 0.0024545756895939844*preszero*(x**2 + z**2)**8 &
         + 0.00018182042145140624*preszero*(x**2 + z**2)**9)

    bz0_l(3) = (0.11253953951963827* &
         (0. - 0.21641620500000003*z + 6.45367005*preszero*z &
         + 0.6492486150000001*z*(x**2 + z**2) &
         - 17.638059524400003*preszero*z*(x**2 + z**2) &
         - 0.7213873500000001*z*(x**2 + z**2)**2 &
         + 19.723090085028453*preszero*z*(x**2 + z**2)**2 &
         + 0.36069367500000005*z*(x**2 + z**2)**3 & 
         - 12.153599550456903*preszero*z*(x**2 + z**2)**3 &
         - 0.07213873500000001*z*(x**2 + z**2)**4 &
         + 4.542701632412481*preszero*z*(x**2 + z**2)**4 &
         - 1.1432456270094133*preszero*z*(x**2 + z**2)**5 &
         + 0.2233663877530526*preszero*z*(x**2 + z**2)**6 &
         - 0.03927321103350375*preszero*z*(x**2 + z**2)**7 &
         + 0.003272767586125312*preszero*z*(x**2 + z**2)**8))/ &
         Sqrt(1.8038251465091153 - 0.9579835619689772*preszero &
         - 0.10820810250000001*(x**2 + z**2) &
         + 3.226835025*preszero*(x**2 + z**2) &
         + 0.16231215375000002*(x**2 + z**2)**2 &
         - 4.409514881100001*preszero*(x**2 + z**2)**2 &
         - 0.12023122500000001*(x**2 + z**2)**3 &
         + 3.287181680838075*preszero*(x**2 + z**2)**3 &
         + 0.045086709375000006*(x**2 + z**2)**4 &
         - 1.5191999438071129*preszero*(x**2 + z**2)**4 &
         - 0.0072138735000000015*(x**2 + z**2)**5 &
         + 0.4542701632412481*preszero*(x**2 + z**2)**5 &
         - 0.09527046891745111*preszero*(x**2 + z**2)**6 &
         + 0.0159547419823609*preszero*(x**2 + z**2)**7 &
         - 0.0024545756895939844*preszero*(x**2 + z**2)**8 &
         + 0.00018182042145140624*preszero*(x**2 + z**2)**9)

    bz0_l(4) = (-0.056269769759819135* &
         (0. - 0.21641620500000003*x + 6.45367005*preszero*x &
         + 0.6492486150000001*x*(x**2 + z**2) &
         - 17.638059524400003*preszero*x*(x**2 + z**2) &
         - 0.7213873500000001*x*(x**2 + z**2)**2 &
         + 19.723090085028453*preszero*x*(x**2 + z**2)**2 &
         + 0.36069367500000005*x*(x**2 + z**2)**3 &
         - 12.153599550456903*preszero*x*(x**2 + z**2)**3 &
         - 0.07213873500000001*x*(x**2 + z**2)**4 &
         + 4.542701632412481*preszero*x*(x**2 + z**2)**4 &
         - 1.1432456270094133*preszero*x*(x**2 + z**2)**5 &
         + 0.2233663877530526*preszero*x*(x**2 + z**2)**6 &
         - 0.03927321103350375*preszero*x*(x**2 + z**2)**7 &
         + 0.003272767586125312*preszero*x*(x**2 + z**2)**8)**2)/ &
         (1.8038251465091153 - 0.9579835619689772*preszero &
         - 0.10820810250000001*(x**2 + z**2) &
         + 3.226835025*preszero*(x**2 + z**2) &
         + 0.16231215375000002*(x**2 + z**2)**2 &
         - 4.409514881100001*preszero*(x**2 + z**2)**2 &
         - 0.12023122500000001*(x**2 + z**2)**3 &
         + 3.287181680838075*preszero*(x**2 + z**2)**3 & 
         + 0.045086709375000006*(x**2 + z**2)**4 &
         - 1.5191999438071129*preszero*(x**2 + z**2)**4 &
         - 0.0072138735000000015*(x**2 + z**2)**5 &
         + 0.4542701632412481*preszero*(x**2 + z**2)**5 &
         - 0.09527046891745111*preszero*(x**2 + z**2)**6 &
         + 0.0159547419823609*preszero*(x**2 + z**2)**7 &
         - 0.0024545756895939844*preszero*(x**2 + z**2)**8 &
         + 0.00018182042145140624*preszero*(x**2 + z**2)**9)**1.5 &
         + (0.11253953951963827*&
         (-0.21641620500000003 + 6.45367005*preszero &
         + 1.2984972300000002*x**2 - 35.276119048800005*preszero*x**2 &
         + 0.6492486150000001*(x**2 + z**2) &
         - 17.638059524400003*preszero*(x**2 + z**2) &
         - 2.8855494000000004*x**2*(x**2 + z**2) &
         + 78.89236034011381*preszero*x**2*(x**2 + z**2) &
         - 0.7213873500000001*(x**2 + z**2)**2 &
         + 19.723090085028453*preszero*(x**2 + z**2)**2 &
         + 2.1641620500000003*x**2*(x**2 + z**2)**2 &
         - 72.92159730274142*preszero*x**2*(x**2 + z**2)**2 &
         + 0.36069367500000005*(x**2 + z**2)**3 &
         - 12.153599550456903*preszero*(x**2 + z**2)**3 &
         - 0.5771098800000001*x**2*(x**2 + z**2)**3 &
         + 36.341613059299846*preszero*x**2*(x**2 + z**2)**3 &
         - 0.07213873500000001*(x**2 + z**2)**4 &
         + 4.542701632412481*preszero*(x**2 + z**2)**4 &
         - 11.432456270094134*preszero*x**2*(x**2 + z**2)**4 &
         - 1.1432456270094133*preszero*(x**2 + z**2)**5 &
         + 2.680396653036631*preszero*x**2*(x**2 + z**2)**5 &
         + 0.2233663877530526*preszero*(x**2 + z**2)**6 &
         - 0.5498249544690526*preszero*x**2*(x**2 + z**2)**6 &
         - 0.03927321103350375*preszero*(x**2 + z**2)**7 &
         + 0.052364281378004994*preszero*x**2*(x**2 + z**2)**7 &
         + 0.003272767586125312*preszero*(x**2 + z**2)**8))/ &
         Sqrt(1.8038251465091153 - 0.9579835619689772*preszero &
         - 0.10820810250000001*(x**2 + z**2) &
         + 3.226835025*preszero*(x**2 + z**2) &
         + 0.16231215375000002*(x**2 + z**2)**2 &
         - 4.409514881100001*preszero*(x**2 + z**2)**2 &
         - 0.12023122500000001*(x**2 + z**2)**3 &
         + 3.287181680838075*preszero*(x**2 + z**2)**3 &
         + 0.045086709375000006*(x**2 + z**2)**4 &
         - 1.5191999438071129*preszero*(x**2 + z**2)**4 &
         - 0.0072138735000000015*(x**2 + z**2)**5 &
         + 0.4542701632412481*preszero*(x**2 + z**2)**5 &
         - 0.09527046891745111*preszero*(x**2 + z**2)**6 &
         + 0.0159547419823609*preszero*(x**2 + z**2)**7 &
         - 0.0024545756895939844*preszero*(x**2 + z**2)**8 &
         + 0.00018182042145140624*preszero*(x**2 + z**2)**9)

    bz0_l(5) = (-0.056269769759819135* &
         (0. - 0.21641620500000003*x + 6.45367005*preszero*x &
         + 0.6492486150000001*x*(x**2 + z**2) &
         - 17.638059524400003*preszero*x*(x**2 + z**2) &
         - 0.7213873500000001*x*(x**2 + z**2)**2 &
         + 19.723090085028453*preszero*x*(x**2 + z**2)**2 &
         + 0.36069367500000005*x*(x**2 + z**2)**3 &
         - 12.153599550456903*preszero*x*(x**2 + z**2)**3 &
         - 0.07213873500000001*x*(x**2 + z**2)**4 &
         + 4.542701632412481*preszero*x*(x**2 + z**2)**4 &
         - 1.1432456270094133*preszero*x*(x**2 + z**2)**5 &
         + 0.2233663877530526*preszero*x*(x**2 + z**2)**6 &
         - 0.03927321103350375*preszero*x*(x**2 + z**2)**7 &
         + 0.003272767586125312*preszero*x*(x**2 + z**2)**8)* &
         (0. - 0.21641620500000003*z + 6.45367005*preszero*z &
         + 0.6492486150000001*z*(x**2 + z**2) &
         - 17.638059524400003*preszero*z*(x**2 + z**2) &
         - 0.7213873500000001*z*(x**2 + z**2)**2 &
         + 19.723090085028453*preszero*z*(x**2 + z**2)**2 &
         + 0.36069367500000005*z*(x**2 + z**2)**3 &
         - 12.153599550456903*preszero*z*(x**2 + z**2)**3 &
         - 0.07213873500000001*z*(x**2 + z**2)**4 &
         + 4.542701632412481*preszero*z*(x**2 + z**2)**4 &
         - 1.1432456270094133*preszero*z*(x**2 + z**2)**5 &
         + 0.2233663877530526*preszero*z*(x**2 + z**2)**6 &
         - 0.03927321103350375*preszero*z*(x**2 + z**2)**7 &
         + 0.003272767586125312*preszero*z*(x**2 + z**2)**8))/ &
         (1.8038251465091153 - 0.9579835619689772*preszero &
         - 0.10820810250000001*(x**2 + z**2) &
         + 3.226835025*preszero*(x**2 + z**2) &
         + 0.16231215375000002*(x**2 + z**2)**2 &
         - 4.409514881100001*preszero*(x**2 + z**2)**2 &
         - 0.12023122500000001*(x**2 + z**2)**3 &
         + 3.287181680838075*preszero*(x**2 + z**2)**3 &
         + 0.045086709375000006*(x**2 + z**2)**4 &
         - 1.5191999438071129*preszero*(x**2 + z**2)**4 &
         - 0.0072138735000000015*(x**2 + z**2)**5 &
         + 0.4542701632412481*preszero*(x**2 + z**2)**5 &
         - 0.09527046891745111*preszero*(x**2 + z**2)**6 &
         + 0.0159547419823609*preszero*(x**2 + z**2)**7 &
         - 0.0024545756895939844*preszero*(x**2 + z**2)**8 &
         + 0.00018182042145140624*preszero*(x**2 + z**2)**9)**1.5 &
         +(0.11253953951963827* &
         (1.2984972300000002*x*z - 35.276119048800005*preszero*x*z &
         - 2.8855494000000004*x*z*(x**2 + z**2) &
         + 78.89236034011381*preszero*x*z*(x**2 + z**2) &
         + 2.1641620500000003*x*z*(x**2 + z**2)**2 &
         - 72.92159730274142*preszero*x*z*(x**2 + z**2)**2 &
         - 0.5771098800000001*x*z*(x**2 + z**2)**3 &
         + 36.341613059299846*preszero*x*z*(x**2 + z**2)**3 &
         - 11.432456270094134*preszero*x*z*(x**2 + z**2)**4 &
         + 2.680396653036631*preszero*x*z*(x**2 + z**2)**5 &
         - 0.5498249544690526*preszero*x*z*(x**2 + z**2)**6 &
         + 0.052364281378004994*preszero*x*z*(x**2 + z**2)**7))/ &
         Sqrt(1.8038251465091153 - 0.9579835619689772*preszero &
         - 0.10820810250000001*(x**2 + z**2) &
         + 3.226835025*preszero*(x**2 + z**2) &
         + 0.16231215375000002*(x**2 + z**2)**2 &
         - 4.409514881100001*preszero*(x**2 + z**2)**2 &
         - 0.12023122500000001*(x**2 + z**2)**3 &
         + 3.287181680838075*preszero*(x**2 + z**2)**3 &
         + 0.045086709375000006*(x**2 + z**2)**4 &
         - 1.5191999438071129*preszero*(x**2 + z**2)**4 &
         - 0.0072138735000000015*(x**2 + z**2)**5 &
         + 0.4542701632412481*preszero*(x**2 + z**2)**5 &
         - 0.09527046891745111*preszero*(x**2 + z**2)**6 &
         + 0.0159547419823609*preszero*(x**2 + z**2)**7 &
         - 0.0024545756895939844*preszero*(x**2 + z**2)**8 &
         + 0.00018182042145140624*preszero*(x**2 + z**2)**9)

    bz0_l(6) = (-0.056269769759819135* &
         (0. - 0.21641620500000003*z + 6.45367005*preszero*z &
         + 0.6492486150000001*z*(x**2 + z**2) &
         - 17.638059524400003*preszero*z*(x**2 + z**2) &
         - 0.7213873500000001*z*(x**2 + z**2)**2 &
         + 19.723090085028453*preszero*z*(x**2 + z**2)**2 &
         + 0.36069367500000005*z*(x**2 + z**2)**3 &
         - 12.153599550456903*preszero*z*(x**2 + z**2)**3 &
         - 0.07213873500000001*z*(x**2 + z**2)**4 &
         + 4.542701632412481*preszero*z*(x**2 + z**2)**4 &
         - 1.1432456270094133*preszero*z*(x**2 + z**2)**5 &
         + 0.2233663877530526*preszero*z*(x**2 + z**2)**6 &
         - 0.03927321103350375*preszero*z*(x**2 + z**2)**7 &
         + 0.003272767586125312*preszero*z*(x**2 + z**2)**8)**2)/ &
         (1.8038251465091153 - 0.9579835619689772*preszero &
         - 0.10820810250000001*(x**2 + z**2) &
         + 3.226835025*preszero*(x**2 + z**2) &
         + 0.16231215375000002*(x**2 + z**2)**2 &
         - 4.409514881100001*preszero*(x**2 + z**2)**2 &
         - 0.12023122500000001*(x**2 + z**2)**3 &
         + 3.287181680838075*preszero*(x**2 + z**2)**3 &
         + 0.045086709375000006*(x**2 + z**2)**4 &
         - 1.5191999438071129*preszero*(x**2 + z**2)**4 &
         - 0.0072138735000000015*(x**2 + z**2)**5 &
         + 0.4542701632412481*preszero*(x**2 + z**2)**5 &
         - 0.09527046891745111*preszero*(x**2 + z**2)**6 &
         + 0.0159547419823609*preszero*(x**2 + z**2)**7 &
         - 0.0024545756895939844*preszero*(x**2 + z**2)**8 &
         + 0.00018182042145140624*preszero*(x**2 + z**2)**9)**1.5 &
         + (0.11253953951963827* &
         (-0.21641620500000003 + 6.45367005*preszero &
         + 1.2984972300000002*z**2 - 35.276119048800005*preszero*z**2 &
         + 0.6492486150000001*(x**2 + z**2) &
         - 17.638059524400003*preszero*(x**2 + z**2) &
         - 2.8855494000000004*z**2*(x**2 + z**2) &
         + 78.89236034011381*preszero*z**2*(x**2 + z**2) &
         - 0.7213873500000001*(x**2 + z**2)**2 &
         + 19.723090085028453*preszero*(x**2 + z**2)**2 &
         + 2.1641620500000003*z**2*(x**2 + z**2)**2 &
         - 72.92159730274142*preszero*z**2*(x**2 + z**2)**2 &
         + 0.36069367500000005*(x**2 + z**2)**3 &
         - 12.153599550456903*preszero*(x**2 + z**2)**3 &
         - 0.5771098800000001*z**2*(x**2 + z**2)**3 &
         + 36.341613059299846*preszero*z**2*(x**2 + z**2)**3 &
         - 0.07213873500000001*(x**2 + z**2)**4 &
         + 4.542701632412481*preszero*(x**2 + z**2)**4 &
         - 11.432456270094134*preszero*z**2*(x**2 + z**2)**4 &
         - 1.1432456270094133*preszero*(x**2 + z**2)**5 &
         + 2.680396653036631*preszero*z**2*(x**2 + z**2)**5 &
         + 0.2233663877530526*preszero*(x**2 + z**2)**6 &
         - 0.5498249544690526*preszero*z**2*(x**2 + z**2)**6 &
         - 0.03927321103350375*preszero*(x**2 + z**2)**7 &
         + 0.052364281378004994*preszero*z**2*(x**2 + z**2)**7 &
         + 0.003272767586125312*preszero*(x**2 + z**2)**8))/ &
         Sqrt(1.8038251465091153 - 0.9579835619689772*preszero &
         - 0.10820810250000001*(x**2 + z**2) &
         + 3.226835025*preszero*(x**2 + z**2) &
         + 0.16231215375000002*(x**2 + z**2)**2 &
         - 4.409514881100001*preszero*(x**2 + z**2)**2 &
         - 0.12023122500000001*(x**2 + z**2)**3 &
         + 3.287181680838075*preszero*(x**2 + z**2)**3 &
         + 0.045086709375000006*(x**2 + z**2)**4 &
         - 1.5191999438071129*preszero*(x**2 + z**2)**4 &
         - 0.0072138735000000015*(x**2 + z**2)**5 &
         + 0.4542701632412481*preszero*(x**2 + z**2)**5 &
         - 0.09527046891745111*preszero*(x**2 + z**2)**6 &
         + 0.0159547419823609*preszero*(x**2 + z**2)**7 & 
         - 0.0024545756895939844*preszero*(x**2 + z**2)**8 &
         + 0.00018182042145140624*preszero*(x**2 + z**2)**9)

    p0_l(1) =preszero*(1. - 3.106*(x**2 + z**2) + 3.54*(x**2 + z**2)**2 - 1.408*(x**2 + z**2)**3)                         
    p0_l(2) =preszero*(-6.212*x + 14.16*x*(x**2 + z**2) - 8.448*x*(x**2 + z**2)**2)                                       
    p0_l(3) =preszero*(-6.212*z + 14.16*z*(x**2 + z**2) - 8.448*z*(x**2 + z**2)**2)                                       
    p0_l(4) =preszero*(-6.212 + 28.32*(x**2) + 14.16*(x**2 + z**2) - 33.792*(x**2)*(x**2 + z**2) - 8.448*(x**2 + z**2)**2) 
    p0_l(5) =preszero*(28.32*x*z - 33.792*x*z*(x**2 + z**2))
    p0_l(6) =preszero*(-6.212 + 28.32*(z**2) + 14.16*(x**2 + z**2) - 33.792*(z**2)*(x**2 + z**2) - 8.448*(x**2 + z**2)**2) 

    pe0_l(1) = p0_l(1)/2.
    pe0_l(2) = p0_l(2)/2.
    pe0_l(3) = p0_l(3)/2.
    pe0_l(4) = p0_l(4)/2.
    pe0_l(5) = p0_l(5)/2.
    pe0_l(6) = p0_l(6)/2.

    den0_l(1) =1. - 1.6*(x**2 + z**2) + 0.8*(x**2 + z**2)**2 - 3.677e-8*(x**2 + z**2)**3
    den0_l(2) =-3.2*x + 3.2*x*(x**2 + z**2) - 2.2062e-7*x*(x**2 + z**2)**2
    den0_l(3) =-3.2*z + 3.2*z*(x**2 + z**2) - 2.2062e-7*z*(x**2 + z**2)**2
    den0_l(4) =-3.2 + 6.4*(x**2) + 3.2*(x**2 + z**2) - 8.8248e-7*(x**2)*(x**2 + z**2) - 2.2062e-7*(x**2 + z**2)**2
    den0_l(5) =6.4*x*z - 8.8248e-7*x*z*(x**2 + z**2)
    den0_l(6) =-3.2 + 6.4*(z**2) + 3.2*(x**2 + z**2) - 8.8248e-7*(z**2)*(x**2 + z**2) - 2.2062e-7*(x**2 + z**2)**2

  end if

  call constant_field(u0_l, 0.)
  call constant_field(vz0_l, 0.)
  call constant_field(chi0_l, 0.)

  psi0_l(1) = alpha * ( r**2/4. - r**4/(8. * rmin**2)               + r**6/(36. * rmin**4)    )
  psi0_l(2) = alpha * ( x/2.    - r**2 * x/(2. * rmin**2)           + r**4 * x/(6. * rmin**4) )
  psi0_l(3) = alpha * ( z/2.    - r**2 * z/(2. * rmin**2)           + r**4 * z/(6. * rmin**4) )
  psi0_l(4) = alpha * ( 1./2.   - (3. * x**2 + z**2)/(2. * rmin**2) + (5. * x**4 + 6. * x**2 * z**2 + z**4)/(6. * rmin**4) )
  psi0_l(5) = alpha * (         - x * z / rmin**2                   + (x**3 * z + x * z**3) * 2./(3. * rmin**4) )
  psi0_l(6) = alpha * ( 1./2.   - (x**2 + 3. * z**2)/(2. * rmin**2) + (x**4 + 6. * x**2 * z**2 + 5. * z**4)/(6. * rmin**4) )
 

end subroutine int_kink_equ


!========================================================
! per
!========================================================
subroutine int_kink_per(x, phi, z)

  use basic
  use arrays
  use diagnostics
  use mesh_mod

  implicit none

  real :: x, phi, z
  vectype, dimension(dofs_per_node) :: vmask

     ! add random perturbations
        vmask(1) = 1.
        vmask(2:dofs_per_node) = 0.
     call random_per(x,phi,z,vmask)





end subroutine int_kink_per

end module int_kink
