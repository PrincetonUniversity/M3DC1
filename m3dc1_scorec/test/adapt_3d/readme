++++++++++++++++++++++++++++++++++++++++++
  mesh adaptation by error estimator
++++++++++++++++++++++++++++++++++++++++++

Modify L295-299 in newpar.f90 as the following:

!    if (nplanes .eq. 1) then
!      call adapt_by_psi
!    else
      call adapt_by_error
!    end if

To run in 2D:
cp 2p-C1input C1input
mpirun -n 2 $M3DC1_DIR/unstructured/_avatar-opt-25/m3dc1_2d

To run in 3D:
cp 8p-C1input C1input
mpirun -np 8 $M3DC1_DIR/unstructured/_avatar-3d-opt-60/m3dc1_3d -ipetsc -options_file options_bjacobi


++++++++++++++++++++++++++++++++++++++++++
  stand-alone test for 3D mesh adaptation
++++++++++++++++++++++++++++++++++++++++++

[Compilation]
PETSC_DIR=/lore/seol/petsc-3.13.5
PETSC_ARCH=real-gcc4.8.5-v5m6xwi-mpich3.2.1-geowaxe
ZOLTAN_DIR=$PETSC_DIR/$PETSC_ARCH
PUMI_DIR=/lore/seol/rhel7-gcc4.8.5-v5m6xwi-mpich3.2.1-geowaxe
PREFIX=$PUMI_DIR

#real
mpicxx -g main.cc -o adapt -DM3DC1_PETSC -I/usr/include -I$PREFIX/include -I$PUMI_DIR/include -I$PETSC_DIR/include -I$PETSC_DIR/$PETSC_ARCH/include -L$PREFIX/lib -lm3dc1_scorec -Wl,--start-group,-rpath,$PUMI_DIR/lib -L$PUMI_DIR/lib -lpumi -lapf -lapf_zoltan -lgmi -llion -lma -lmds -lmth -lparma -lpcu -lph -lsam -lspr -lcrv -Wl,--end-group -L$ZOLTAN_DIR/lib -lzoltan -L$PETSC_DIR/$PETSC_ARCH/lib -Wl,-rpath,$PETSC_DIR/$PETSC_ARCH/lib -L$PETSC_DIR/$PETSC_ARCH/lib -L/opt/scorec/spack/install/linux-rhel7-x86_64/gcc-4.8.5/mpich-3.2.1-geowaxeufjfz7vgpszmfrm4l6rp4rnxo/lib -Wl,-rpath,/opt/scorec/spack/install/linux-rhel7-x86_64/gcc-rhel7_4.8.5/gcc-4.8.5-v5m6xwipewvkufflu3zvxs2x6jv4libr/lib:/opt/scorec/spack/install/linux-rhel7-x86_64/gcc-rhel7_4.8.5/gcc-4.8.5-v5m6xwipewvkufflu3zvxs2x6jv4libr/lib64 -L/opt/scorec/spack/install/linux-rhel7-x86_64/gcc-rhel7_4.8.5/gcc-4.8.5-v5m6xwipewvkufflu3zvxs2x6jv4libr/lib64 -L/opt/scorec/spack/install/linux-rhel7-x86_64/gcc-rhel7_4.8.5/gcc-4.8.5-v5m6xwipewvkufflu3zvxs2x6jv4libr/lib/gcc/x86_64-unknown-linux-gnu/4.8.5 -L/opt/scorec/spack/install/linux-rhel7-x86_64/gcc-4.8.5/hdf5-1.10.4-wousvnks7b7aplenali7jg5bsh243hyd/lib -L/opt/scorec/spack/install/linux-rhel7-x86_64/gcc-4.8.5/zlib-1.2.11-vhzh5cfaki5lx5sjuth5iuojq5azdkbd/lib -L/opt/scorec/spack/install/linux-rhel7-x86_64/gcc-rhel7_4.8.5/gcc-4.8.5-v5m6xwipewvkufflu3zvxs2x6jv4libr/lib -Wl,-rpath,/opt/scorec/spack/install/linux-rhel7-x86_64/gcc-4.8.5/mpich-3.2.1-geowaxeufjfz7vgpszmfrm4l6rp4rnxo/lib -lpetsc -lcmumps -ldmumps -lsmumps -lzmumps -lmumps_common -lpord -lpthread -lscalapack -lsuperlu -lsuperlu_dist -lfftw3_mpi -lfftw3 -lflapack -lfblas -lzoltan -lpthread -lX11 -lhdf5hl_fortran -lhdf5_fortran -lhdf5_hl -lhdf5 -lparmetis -lmetis -lm -lz -lstdc++ -ldl -lmpifort -lmpi -lgfortran -lm -lgfortran -lm -lgcc_s -lquadmath -lstdc++ -ldl

#complex
Add -DPETSC_USE_COMPLEX and replace -lm3dc1_scorec with -lm3dc1_scorec_complex


[Usage]
mpirun -np P ./adapt model mesh #planes model/mesh_load_option
#planes: if not provided, the default is -1
         -1 for PUMI model and mesh (.dmg and .smb)
         1 for 2D with M3DC1 model and mesh (.txt and .smb)
         n>1 for 3D with M3DC1 model and mesh (.txt and .smb)
 
load_option: if not provided, the default is 0 
             0 for loading M3DC1 model (.txt) and 2D mesh file for both 2D and 3D run
             1 for loading M3DC1 model (.txt) and 3D mesh file for 3D run (no 3D mesh construction)

[Examples]
(1) load .dmg model and 2D mesh
mpirun -np 1 ./adapt /lore/seol/meshes/xgc/g096333.03337_pumiModel.dmg /lore/seol/meshes/xgc/g096333.03337_pumiMesh.smb 

(2) load .dmg model and 3D mesh
mpirun -np 4 ./adapt /lore/seol/meshes/torus/torus.dmg /lore/seol/meshes/torus/4imb/torus.smb

(3) load .txt model and 2D mesh then construct 3D mesh
mpirun -np 4  ./adapt tilt.txt tilt.smb 2
mpirun -np 8 ./adapt tilt.txt tilt.smb 4
// FIXME: crash in apf::reorderMdsMesh after adaptation
mpirun -np 64 ./adapt ../nate-32part/diiid0.05.txt ../nate-32part/mesh.smb 2 

(4) load .txt model and distributed 3D mesh (no 3D mesh extrusion)
// FIXME: crash in the beginning of adaptation
mpirun -np 64 ./adapt /lore/seol/tests/adapt/3d-adapt-64p/diiid-0.02-2.5-4.0.txt /lore/seol/tests/adapt/3d-adapt-64p/part_64p.smb 4 1


